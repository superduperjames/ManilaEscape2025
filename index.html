<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>üé° Ghoul Swap Spinner</title>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap');

    body {
      font-family: 'Poppins', sans-serif;
      background: url('https://res.cloudinary.com/eventmobi/image/upload/v1759429344/_James%20Assets/.test%20app%20assets/MML%20October%202025/ezgif.com-effects.gif') no-repeat center center fixed;
      background-size: cover;
      margin: 0;
      height: 100vh;
      color: #fff;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      text-align: center;
      overflow: hidden;
    }

    h1 {
      font-size: 2em;
      color: #ffb3b3;
      text-shadow: 0 0 15px rgba(255, 0, 0, 0.8);
      margin-bottom: 25px;
    }

    .spinner-container {
      position: relative;
      width: 280px;
      height: 280px;
      margin-bottom: 40px;
    }

    .wheel {
      width: 100%;
      height: 100%;
      border-radius: 50%;
      border: 8px solid #ff4b4b;
      background: conic-gradient(
        #ff6f61 0deg 45deg,
        #f7b267 45deg 90deg,
        #f79d65 90deg 135deg,
        #f4845f 135deg 180deg,
        #ffb997 180deg 225deg,
        #ff9b85 225deg 270deg,
        #f27059 270deg 315deg,
        #ff6b6b 315deg 360deg
      );
      transition: transform 4s cubic-bezier(0.25, 0.1, 0.25, 1);
      box-shadow: 0 0 40px rgba(255, 0, 0, 0.5);
    }

    .pointer {
      position: absolute;
      top: -25px;
      left: 50%;
      transform: translateX(-50%);
      width: 0;
      height: 0;
      border-left: 15px solid transparent;
      border-right: 15px solid transparent;
      border-bottom: 25px solid #fff;
      filter: drop-shadow(0 0 5px #ff0000);
    }

    button {
      background: #ff4b4b;
      color: white;
      border: none;
      padding: 14px 25px;
      font-size: 1em;
      border-radius: 10px;
      cursor: pointer;
      transition: all 0.3s ease;
      box-shadow: 0 0 15px rgba(255, 75, 75, 0.6);
    }

    button:hover {
      background: #ff2222;
      transform: scale(1.05);
    }

    .result {
      margin-top: 20px;
      font-size: 1.2em;
      color: #fff;
      text-shadow: 0 0 10px rgba(255, 255, 255, 0.4);
    }

    .loading {
      font-size: 1.1em;
      color: #ffb3b3;
      animation: flicker 1.5s infinite alternate;
    }

    @keyframes flicker {
      from { opacity: 0.4; }
      to { opacity: 1; }
    }

    footer {
      position: fixed;
      bottom: 10px;
      font-size: 0.8em;
      color: rgba(255,255,255,0.5);
    }
  </style>
</head>
<body>
  <h1>üï∏Ô∏è Spin to Reveal Your Ghoul Swap Match!</h1>

  <div class="spinner-container">
    <div class="pointer"></div>
    <div class="wheel" id="wheel"></div>
  </div>

  <button id="spinBtn">Spin the Wheel</button>

  <div class="result" id="result">Who will you haunt with gifts? üëÄ</div>

  <footer>Manila Escape 2025 ‚Ä¢ Ghoul Swap Spinner</footer>

  <script>
    const scriptURL = 'https://script.google.com/macros/s/AKfycbyg8geKLRkYaWmhs9QkYHTcuk4fqnUK6rnbccf0073iiuTkL4ZM-70lJAWKxxfMbRtgew/exec';
    const wheel = document.getElementById('wheel');
    const resultDiv = document.getElementById('result');
    const spinBtn = document.getElementById('spinBtn');

    let spinning = false;

    async function fetchGhouls() {
      try {
        resultDiv.textContent = "Fetching ghouls from the underworld...";
        const response = await fetch(`${scriptURL}?action=getGhouls`);
        const data = await response.json();
        return data.ghouls || [];
      } catch (error) {
        console.error("Error fetching ghouls:", error);
        resultDiv.textContent = "‚ö†Ô∏è Couldn't fetch ghouls. Try again later.";
        return [];
      }
    }

    async function spinWheel() {
      if (spinning) return;
      spinning = true;
      resultDiv.textContent = "Spinning... üåÄ";
      spinBtn.disabled = true;

      const ghouls = await fetchGhouls();
      if (ghouls.length === 0) {
        resultDiv.textContent = "üëª No ghouls found!";
        spinBtn.disabled = false;
        spinning = false;
        return;
      }

      const randomIndex = Math.floor(Math.random() * ghouls.length);
      const degrees = 3600 + (360 / ghouls.length) * randomIndex;
      wheel.style.transform = `rotate(${degrees}deg)`;

      setTimeout(() => {
        const chosen = ghouls[randomIndex];
        resultDiv.innerHTML = `üéâ Your Ghoul Swap Match is: <b>${chosen}</b>!`;
        spinBtn.disabled = false;
        spinning = false;
      }, 4500);
    }

    spinBtn.addEventListener('click', spinWheel);
  </script>
</body>
</html>
