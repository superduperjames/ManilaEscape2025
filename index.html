<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Roulette of Fates üëª</title>
<link href="https://fonts.googleapis.com/css2?family=Creepster&family=Montserrat:wght@400;600&display=swap" rel="stylesheet">
<style>
  body {
    background: #000;
    color: #fff;
    font-family: 'Montserrat', sans-serif;
    text-align: center;
    padding: 40px 20px;
  }

  h1 {
    font-family: 'Creepster', cursive;
    font-size: 3em;
    margin-bottom: 10px;
    color: #fff;
    text-shadow: 0 0 10px #fff;
  }

  input, button, textarea {
    font-family: inherit;
  }

  input[type="email"] {
    padding: 10px;
    width: 250px;
    border-radius: 8px;
    border: none;
    text-align: center;
  }

  button {
    padding: 10px 15px;
    border: none;
    border-radius: 8px;
    background: #fff;
    color: #000;
    cursor: pointer;
    transition: all 0.3s ease;
  }

  button:hover {
    box-shadow: 0 0 10px #fff;
    transform: scale(1.05);
  }

  #result-area {
    margin-top: 25px;
    background: #fff;
    color: #000;
    padding: 25px;
    border-radius: 10px;
    max-width: 400px;
    margin: 30px auto;
    box-shadow: 0 0 15px rgba(255,255,255,0.2);
    font-size: 18px;
    display: none;
    animation: fadeBounce 0.8s ease forwards;
  }

  @keyframes fadeBounce {
    0% {opacity:0; transform:translateY(20px);}
    60% {opacity:1; transform:translateY(-8px);}
    100% {transform:translateY(0);}
  }

  #adminPanel {
    display: none;
    text-align: left;
    background: #111;
    border-radius: 10px;
    padding: 20px;
    margin-top: 20px;
    box-shadow: 0 0 10px rgba(255,255,255,0.1);
    max-width: 600px;
    margin-left: auto;
    margin-right: auto;
  }

  textarea {
    width: 100%;
    border-radius: 8px;
    padding: 8px;
    border: none;
    background: #222;
    color: #fff;
    resize: vertical;
  }

  label {font-weight:600;}

  .adminBtn {
    background:#fff;
    color:#000;
    border-radius:6px;
    padding:8px 15px;
    cursor:pointer;
    margin-top:10px;
  }

  .adminBtn:hover {
    box-shadow:0 0 10px #fff;
  }
</style>
</head>
<body>

<h1>üé° Roulette of Fates</h1>
<p>Enter your registered email below and spin for your destiny‚Ä¶</p>

<input type="email" id="email" placeholder="your@email.com">
<button id="spinBtn">Spin</button>

<div id="result-area">
  <h3>Your Result:</h3>
  <div id="resultText">No result yet ‚Äî spin to find out!</div>
</div>

<button id="adminToggle" class="adminBtn">üëª Admin Login</button>

<div id="adminPanel">
  <h2 style="text-align:center;">üïØÔ∏è Admin Panel</h2>
  <label>Emails (one per line):</label><br>
  <textarea id="emailList" rows="6" placeholder="Enter emails here..."></textarea><br><br>
  <label>Results (codename, gender per line):</label><br>
  <textarea id="resultList" rows="6" placeholder="Enter results here..."></textarea><br><br>
  <button id="saveAdmin" class="adminBtn">üíæ Save Lists</button>
</div>

<script>
  const ADMIN_PASSWORD = "escape2025";
  let validEmails = [];
  let results = [];
  let assigned = {};

  // Load from storage
  try {
    validEmails = JSON.parse(localStorage.getItem("validEmails")) || [];
    results = JSON.parse(localStorage.getItem("results")) || [];
    assigned = JSON.parse(localStorage.getItem("assignedRoulette")) || {};
  } catch(e){}

  const emailInput = document.getElementById("email");
  const spinBtn = document.getElementById("spinBtn");
  const resultArea = document.getElementById("result-area");
  const resultText = document.getElementById("resultText");
  const adminPanel = document.getElementById("adminPanel");
  const adminToggle = document.getElementById("adminToggle");

  adminToggle.addEventListener("click", ()=>{
    if(adminPanel.style.display === "block"){
      adminPanel.style.display = "none";
      return;
    }
    const pw = prompt("Enter Admin Password:");
    if(pw === ADMIN_PASSWORD){
      adminPanel.style.display = "block";
      document.getElementById("emailList").value = validEmails.join("\\n");
      document.getElementById("resultList").value = results.map(r=>`${r.codeName}, ${r.gender}`).join("\\n");
    } else {
      alert("‚ùå Incorrect password!");
    }
  });

  document.getElementById("saveAdmin").addEventListener("click", ()=>{
    validEmails = document.getElementById("emailList").value.split("\\n").map(e=>e.trim()).filter(e=>e);
    results = document.getElementById("resultList").value.split("\\n").map(line=>{
      const [codeName, gender] = line.split(",").map(v=>v.trim());
      return {codeName, gender};
    }).filter(r=>r.codeName);
    localStorage.setItem("validEmails", JSON.stringify(validEmails));
    localStorage.setItem("results", JSON.stringify(results));
    alert("‚úÖ Lists saved!");
  });

  spinBtn.addEventListener("click", ()=>{
    const email = emailInput.value.trim().toLowerCase();
    if(!email){
      alert("‚ö†Ô∏è Please enter your email first.");
      return;
    }
    if(!validEmails.includes(email)){
      resultText.textContent = "‚ùå Sorry! Your email is not registered.";
      resultArea.style.display = "block";
      return;
    }

    if(!assigned[email]){
      if(results.length===0){
        resultText.textContent = "‚ö†Ô∏è All results have been assigned!";
        resultArea.style.display = "block";
        return;
      }
      const randomIndex = Math.floor(Math.random()*results.length);
      const chosen = results.splice(randomIndex,1)[0];
      assigned[email] = chosen;
      localStorage.setItem("assignedRoulette", JSON.stringify(assigned));
      localStorage.setItem("results", JSON.stringify(results));
    }

    const chosen = assigned[email];
    resultText.innerHTML = `üéØ <b>Codename:</b> ${chosen.codeName}<br>üë§ <b>Gender:</b> ${chosen.gender}`;
    resultArea.style.display = "block";
    resultArea.style.animation = "fadeBounce 0.8s ease forwards";
  });
</script>
</body>
</html>
